syntax = "proto3";

package proto;

import "google/protobuf/timestamp.proto";

// Event ...
//
// These are events that may occur.
message Event {
  // Event ...
  oneof event {
    // Message types that may occure as event
    Message message = 10;
    Message reply   = 11;
    Message private = 12;

    // Controller/Plugin types that may occure as event.
    Config config     = 20;
    Register register = 21;

    // Errors that may occure as an event
    Error error = 30;
  }
}

// Register ...
//
// Register action for the server.
message Register {
  // Plugin to register ...
  Plugin plugin = 1;
}

// Config ...
//
// Config is a plugin config from the server
message Config {
  // cluster id ...
  string cluster_id   = 1;
  // cluster url ...
  string cluster_url  = 2;
  // inbox ...
  string inbox        = 3;
  // outbox ...
  string outbox       = 4;
  // discovery ...
  string discovery    = 5;
  // debug ...
  bool debug          = 10;
  // verbose ...
  bool verbose        = 11;
}

// Plugin ...
//
// These are all info for a plugin.
message Plugin {
  // name ...
  string name       = 1;
  // identifier ...
  string identifier = 2;
  // version ...
  string version    = 3;
  // path ...
  string path       = 4;
}

// Message
//
// Information from a chat.
message Message {
  // TextFormat ...
  enum TextFormat {
    PLAIN_TEXT = 0;
  }

  // Recipient ...
  //
  // This is the recipient of an interaction ...
  message Recipient {
    // ID ...
    string id     = 1;
    // Name ...
    string name   = 2;
    // Team ...
    Team team     = 3;
  }

  // Channel ...
  //
  // This is the channel of the interaction ...
  message Channel {
    // ID ...
    string id     = 1;
    // Name ...
    string name   = 2;
  }

  // User ...
  //
  // This is a user interaction ...
  message User {
    // ID ...
    string id     = 1;
    // Name ...
    string name   = 2;
    // Team ...
    Team team     = 3;
  }

  // Team ...
  //
  // This is a team interaction ...
  message Team {
    // ID ...
    string id     = 1;
    // Name ...
    string name   = 2;
  }

  // UUID ...
  string uuid             = 1;
  // ID ...
  string id               = 2;
  // Type ...
  string type             = 3;
  // Channel ...
  Channel channel         = 4;
  // From ...
  User from               = 5;
  // Recipient ...
  Recipient recipient     = 6;
  // isBot ...
  bool is_bot             = 7;
  // isDirectMessage ...
  bool is_direct_message  = 8;
  // Timestamp ...
  google.protobuf.Timestamp timestamp = 9;
  // TextFormat ...
  TextFormat text_format = 20;
  // Text ...
  string text            = 21;
}

// Error
//
// These are standard error codes.
message Error {
  // Errors to occur in the communication
  enum Code {
    UNKNOWN         = 0;
    REGISTER        = 1;
    CONFIG          = 2;
    PLAIN_MESSAGE   = 3;
    REPLY_MESSAGE   = 4;
    PRIVATE_MESSAGE = 5;
  }

  Code code = 1;
  string message = 2;
  map<string, string> details = 3;
}

// Empty ...
//
// Empty reply.
message Empty {}
