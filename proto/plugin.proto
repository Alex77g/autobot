syntax = "proto3";

package proto;

import "google/protobuf/timestamp.proto";

// Event ...
//
// These are events that may occur.
message Event {
  // Plugin ...
  Plugin plugin = 1;
  // UUID ...
  string uuid   = 2;

  // Event ...
  oneof event {
    Message message = 10;
    Message reply   = 11;
    Message private = 12;

    Error error     = 20;
  }
}

// Action ...
//
// These are actions performed by the plugins.
message Action {
  // Request ...
  message Request {
    // Action ...
    oneof action {
      Register register = 1;
    }
  }

  // Response ...
  message Response {
    // Reply ...
    oneof reply {
      Registered registered = 1;
    }
  }
}

// Register ...
//
// Register action for the server.
message Register {
  Plugin plugin = 1;
}


// Registered ...
//
// Registered reply for the server
message Registered {
  // Config ...
  Config config   = 1;
}

// Config ...
//
// Config is a plugin config from the server
message Config {
  // cluster id ...
  string cluster_id   = 1;
  // cluster url ...
  string cluster_url  = 2;
  // inbox ...
  string inbox        = 3;
  // outbox ...
  string outbox       = 4;
  // debug ...
  bool debug          = 10;
  // verbose ...
  bool verbose        = 11;
}

// Plugin ...
//
// These are all info for a plugin.
message Plugin {
  // name ...
  string name       = 1;
  // identifier ...
  string identifier = 2;
  // version ...
  string version    = 3;
  // path ...
  string path       = 4;
}

// User ...
//
// This is a user interaction ...
message User {
  // ID ...
  string id     = 1;
  // Name ...
  string name   = 2;
  // Team ...
  Team team     = 3;
}

// Team ...
//
// This is a team interaction ...
message Team {
  // ID ...
  string id     = 1;
  // Name ...
  string name   = 2;
}

// Channel ...
//
// This is the channel of the interaction ...
message Channel {
  // ID ...
  string id     = 1;
  // Name ...
  string name   = 2;
}

// Recipient ...
//
// This is the recipient of an interaction ...
message Recipient {
  // ID ...
  string id     = 1;
  // Name ...
  string name   = 2;
  // Team ...
  Team team     = 3;
}

// Message
//
// Information from a chat.
message Message {
  // TextFormat ...
  enum TextFormat {
    PLAIN_TEXT = 0;
  }

  // ID ...
  string id               = 1;
  // Type ...
  string type             = 2;
  // Channel ...
  Channel channel         = 3;
  // From ...
  User from               = 4;
  // Recipient ...
  Recipient recipient     = 5;
  // isBot ...
  bool is_bot             = 6;
  // isDirectMessage ...
  bool is_direct_message  = 7;
  // Timestamp ...
  google.protobuf.Timestamp timestamp = 10;
  // TextFormat ...
  TextFormat text_format = 20;
  // Text ...
  string text            = 21;
}

// Error
//
// These are standard error codes.
message Error {
  // Errors to occur in the communication
  enum Code {
    UNKNOWN   = 0;
    REGISTER  = 1;
  }

  Code code = 1;
  string message = 2;
}

// Empty ...
//
// Empty reply.
message Empty {}
